<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <title></title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script type="text/javascript" src="js/flexible2.0.js"></script>
    <script type="text/javascript" src="js/zepto.js"></script>
    <script type="text/javascript" src="js/mDialog/mDialog.js"></script>
    <script type="text/javascript" src="js/common.js"></script>
</head>

<body style="background:#f4f6f8">
    @@include("./views/_dialog.html")
    <div class="h-banner"><a href="javascript:void(0);" class="btn-lqwy" id="J_banner-btn-lqwy">领取万元小鱼专属建材大礼包></a><img src="images/h_banner.jpg"></div>
    <div class="h-mod-1">
        <div class="h-title-1">本期优质家居好物</div>
        <div class="swiper-container swiper-container-1">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <div class="pic"><img src="upload/demo_2.jpg" /></div>
                    <div class="avatar-pl">
                        <div class="u-pic"><img src="upload/demo_2.jpg" /></div>
                        <div class="u-name-star clearfix">
                            <span class="name">会飞的猪会飞的猪会飞的猪会飞的猪</span>
                            <span class="star star-1"></span>
                        </div>
                        <div class="u-txt">太棒了，第一次买到这么满意的产. . .</div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="pic"><img src="upload/demo_2.jpg" /></div>
                    <div class="avatar-pl">
                        <div class="u-pic"><img src="upload/demo_2.jpg" /></div>
                        <div class="u-name-star clearfix">
                            <span class="name">会飞的猪会飞的猪会飞的猪会飞的猪</span>
                            <span class="star star-1"></span>
                        </div>
                        <div class="u-txt">太棒了，第一次买到这么满意的产. . .</div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="pic"><img src="upload/demo_2.jpg" /></div>
                    <div class="avatar-pl">
                        <div class="u-pic"><img src="upload/demo_2.jpg" /></div>
                        <div class="u-name-star clearfix">
                            <span class="name">会飞的猪会飞的猪会飞的猪会飞的猪</span>
                            <span class="star star-1"></span>
                        </div>
                        <div class="u-txt">太棒了，第一次买到这么满意的产. . .</div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="pic"><img src="upload/demo_2.jpg" /></div>
                    <div class="avatar-pl">
                        <div class="u-pic"><img src="upload/demo_2.jpg" /></div>
                        <div class="u-name-star clearfix">
                            <span class="name">会飞的猪会飞的猪会飞的猪会飞的猪</span>
                            <span class="star star-1"></span>
                        </div>
                        <div class="u-txt">太棒了，第一次买到这么满意的产. . .</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="h-mod-2">
        <div class="caption"></div>
        <div class="h-mod-2-video"><img src="upload/video_1.jpg"></div>
    </div>
    <div class="h-mod-3">
        <div class="h-title-1">优质商家展示区</div>
        <div class="swiper-container swiper-container-2">
            <div class="swiper-wrapper">
                <div class="swiper-slide"><a href="#" data-type="1" class="active">全部</a></div>
                <div class="swiper-slide"><a href="#" data-type="2">木板</a></div>
                <div class="swiper-slide"><a href="#">建材</a></div>
                <div class="swiper-slide"><a href="#">全部</a></div>
                <div class="swiper-slide"><a href="#">木板</a></div>
                <div class="swiper-slide"><a href="#">建材</a></div>
                <div class="swiper-slide"><a href="#">全部</a></div>
                <div class="swiper-slide"><a href="#">木板</a></div>
                <div class="swiper-slide"><a href="#">建材</a></div>
            </div>
        </div>
        <div class="dropload-scroll-box">
            <ul class="dropload-list-1 clearfix">
                <li>
                    <div class="pic"><img src="upload/demo_3.jpg" /></div>
                </li>
                <li>
                    <div class="pic"><img src="upload/demo_3.jpg" /></div>
                </li>
                <li>
                    <div class="pic"><img src="upload/demo_3.jpg" /></div>
                </li>
                <li>
                    <div class="pic"><img src="upload/demo_3.jpg" /></div>
                </li>
                <li>
                    <div class="pic"><img src="upload/demo_3.jpg" /></div>
                </li>
                <li>
                    <div class="pic"><img src="upload/demo_3.jpg" /></div>
                </li>
                <li>
                    <div class="pic"><img src="upload/demo_3.jpg" /></div>
                </li>
                <li>
                    <div class="pic"><img src="upload/demo_3.jpg" /></div>
                </li>
            </ul>
        </div>
    </div>
    <div class="footer-fixed-seat"></div>
    <ul class="footer-fixed">
        <li class="first active">
            <a href="#">
                <div class="pic"></div>
                <p class="txt">往期回顾</p>
            </a>
        </li>
        <li class="mid" id="J_ft-btn-lqwy">
            <div class="m-pic"></div>
            <p class="txt">免费万元礼包</p>
        </li>
        <li class="last">
            <a href="#">
                <div class="pic"></div>
                <p class="txt">优惠专区</p>
            </a>
        </li>
    </ul>
    <script type="text/javascript" src="js/swiper/js/swiper.min.js"></script>
    <link rel="stylesheet" type="text/css" href="js/swiper/css/swiper.min.css">
    <script type="text/javascript" src="js/dropload/dropload.min.js"></script>
    <link rel="stylesheet" type="text/css" href="js/dropload/dropload.css" />
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript">
    $(function() {
        //开发进行修改
        var dropload;
        var currIndex = 0;
        var itemCurrPage = 1;
        var postData = { "type":1};
        var itemPageNum = 8;
        var initCount = 8; //开发请将首次加载的条数附在这里,如果只有两条数据的时候就不需要下拉加载更多 
        (function() {
            if (initCount >= itemPageNum) {
                dropload = $('.dropload-scroll-box').dropload({
                    scrollArea: window,
                    domDown: {
                        domNoData: '<div class="dropload-noData">òᆺó被你看光啦！</div>'
                    },
                    loadDownFn: function(me) {

                        // 加载菜单一的数据
                        $.ajax({
                            type: 'post',
                            // data:{page:item1CurrPage,num:item1PageNum},
                            url: './php/1.php',
                            data: postData,
                            dataType: 'json',
                            success: function(data) {

                                itemCurrPage++;
                                var result = "";
                                for (var i = 0; i < data.lists.length; i++) {
                                    result += '<li><div class="pic"><img src="' + data.lists[i].pic + '" /></div></li>';
                                }
                                setTimeout(function() { //测试用 后端请删除timeout的函数
                                    $(".dropload-list-1").append(result);
                                    if (!data.lists.length || data.lists.length < itemPageNum) {
                                        // 锁定
                                        me.lock();
                                        // 无数据
                                        me.noData();
                                    }
                                    me.resetload();

                                }, 1000)

                            },
                            error: function(xhr, type) {
                                console.dir('Ajax error!');
                                // 即使加载出错，也得重置
                                me.resetload();
                            }
                        });
                    }
                });
            }
        })();

        $(".swiper-container-2 .swiper-slide a").on("click", function(event) {

            event.preventDefault();
            var $this = $(this);
            $this.addClass("active").parent().siblings().children('a').removeClass('active');
            //点击的不是当前的项
            var newIndex = $(".swiper-container-2 .swiper-slide a").index($this);

            if (newIndex != currIndex) {
               
                currIndex = newIndex;
                itemCurrPage = 1;
                postData["type"] = $this.data("type");
                $.ajax({
                    type: 'post',
                    // data:{page:item1CurrPage,num:item1PageNum},
                    url: './php/1.php',
                    data: postData,
                    dataType: 'json',
                    success: function(data) {

                        itemCurrPage++;
                        var result = "";
                        for (var i = 0; i < data.lists.length; i++) {
                            result += '<li><div class="pic"><img src="' + data.lists[i].pic + '" /></div></li>';
                        }
                        setTimeout(function() { //测试用 后端请删除timeout的函数
                            $(".dropload-list-1").html(result);
                            if (!data.lists.length || data.lists.length < itemPageNum) {
                                // 锁定
                                dropload.lock();
                                // 无数据
                                dropload.noData();
                            }
                            dropload.resetload();

                        }, 1000)

                    },
                    error: function(xhr, type) {
                        console.dir('Ajax error!');
                        // 即使加载出错，也得重置
                        dropload.resetload();
                    }
                });

            }

        })


    });
    </script>
</body>

</html>