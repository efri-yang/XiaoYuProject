<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script type="text/javascript" src="js/zepto.js"></script>
    <script type="text/javascript" src="js/flexible2.0.js"></script>
    <script type="text/javascript" src="js/mdialog/mDialog.js"></script>
    <script type="text/javascript" src="js/dropload/dropload.min.js"></script>
    <link rel="stylesheet" type="text/css" href="js/dropload/dropload.css">
</head>

<body>
    <div class="banner-list"><img src="images/banner_02.jpg" /></div>
     <div class="adv-box-1">
            <span style="height:100%;width:100%;display:block;background:#f60;">广告</span>
        </div>
    <div class="seach-sort-box">
        <div class="sort-item sort-mrpx desc">默认排序<i></i></div>
        <div class="sort-item sort-ps asc">票数排序<i></i></div>
        <div class="seach-box">
            <input type="text" class="ipt-text" placeholder="搜索姓名或编号" />
            <input type="submit" class="ipt-submit" value="搜索">
        </div>
    </div>
    <div class="dropload-scroll-box">
        <ul class="tp-list-1 clearfix">
            <li>
                <div class="num">001号</div>
                <div class="pic"><a href="detail.html"><img src="upload/pic_03.jpg"></a></div>
                <div class="name-ps clearfix">
                    <span class="name">张少儿</span>
                    <span class="piaoshu">票数<strong>12345</strong></span>
                </div>
                <div class="age-rank clearfix">
                    <span class="age">年龄12</span>
                    <span class="rank">排名<strong>1</strong></span>
                </div>
                <a href="#" class="tp-btn disabled">投TA一票</a>
            </li>
            <li>
                <div class="num">001号</div>
                <div class="pic"><a href="detail.html"><img src="upload/pic_01.jpg"></a></div>
                <div class="name-ps clearfix">
                    <span class="name">张少儿</span>
                    <span class="piaoshu">票数<strong>12345</strong></span>
                </div>
                <div class="age-rank clearfix">
                    <span class="age">年龄12</span>
                    <span class="rank">排名<strong>1</strong></span>
                </div>
                <a href="#" class="tp-btn">投TA一票</a>
            </li>
            <li>
                <div class="num">001号</div>
                <div class="pic"><a href="#"><img src="upload/pic_03.jpg"></a></div>
                <div class="name-ps clearfix">
                    <span class="name">张玉婷</span>
                    <span class="piaoshu">票数<strong>12345</strong></span>
                </div>
                <div class="age-rank clearfix">
                    <span class="age">年龄12</span>
                    <span class="rank">排名<strong>1</strong></span>
                </div>
                <a href="#" class="tp-btn disabled">投TA一票</a>
            </li>
            <li>
                <div class="num">001号</div>
                <div class="pic"><a href="#"><img src="upload/pic_01.jpg"></a></div>
                <div class="name-ps clearfix">
                    <span class="name">张玉婷</span>
                    <span class="piaoshu">票数<strong>12345</strong></span>
                </div>
                <div class="age-rank clearfix">
                    <span class="age">年龄12</span>
                    <span class="rank">排名<strong>1</strong></span>
                </div>
                <a href="#" class="tp-btn">投TA一票</a>
            </li>
            <li>
                <div class="num">001号</div>
                <div class="pic"><a href="#"><img src="upload/pic_03.jpg"></a></div>
                <div class="name-ps clearfix">
                    <span class="name">张玉婷</span>
                    <span class="piaoshu">票数<strong>12345</strong></span>
                </div>
                <div class="age-rank clearfix">
                    <span class="age">年龄12</span>
                    <span class="rank">排名<strong>1</strong></span>
                </div>
                <a href="#" class="tp-btn disabled">投TA一票</a>
            </li>
            <li>
                <div class="num">001号</div>
                <div class="pic"><a href="#"><img src="upload/pic_01.jpg"></a></div>
                <div class="name-ps clearfix">
                    <span class="name">张玉婷</span>
                    <span class="piaoshu">票数<strong>12345</strong></span>
                </div>
                <div class="age-rank clearfix">
                    <span class="age">年龄12</span>
                    <span class="rank">排名<strong>1</strong></span>
                </div>
                <a href="#" class="tp-btn">投TA一票</a>
            </li>
        </ul>
    </div>
    <div class="foot-fixed-bottom-seat"></div>
    <ul class="foot-fixed-bottom">
        <li><a href="index.html">首页</a></li>
        <li><a href="list-youer.html">幼儿组</a></li>
        <li class="active"><a href="list-shaoer.html">少儿组</a></li>
        <li><a href="baoming.html">报名参赛</a></li>
    </ul>
    <script type="text/javascript">
    $(function() {
        $(document).on("click", ".tp-btn", function(event) {
            event.preventDefault();
            //本代码只负责展示，开发根据ajax进行修改
            var tpDialog = mDialog.load({
                text: "",
                duration: 250,
                shade: { opacity: 0 },
                shadeClose: false,
                onShow: function() {

                },
                onClose: function() {

                }
            });
            setTimeout(function() {
                tpDialog.close();
                mDialog.msg({ content: "<span style='white-space: nowrap'>投票成功!</span>" })
            }, 2000)
        });


        //开发进行修改
        (function() {
            var itemCurrPage = 1;
            var itemPageNum = 8;

            var initCount=8;//开发请将首次加载的条数附在这里,如果只有两条数据的时候就不需要下拉加载更多 
            if(initCount >=itemPageNum){
                var dropload = $('.dropload-scroll-box').dropload({
                scrollArea: window,
                domDown : {
                    domNoData  : '<div class="dropload-noData">òᆺó被你看光啦！</div>'
                },
                loadDownFn: function(me) {

                    // 加载菜单一的数据
                    $.ajax({
                        type: 'GET',
                        // data:{page:item1CurrPage,num:item1PageNum},
                        url: './',
                        dataType: 'json',
                        success: function(data) {
                            var data = {
                                "lists": [{},{},{}]
                            }
                            itemCurrPage++;
                            var result = "";
                            for (var i = 0; i < data.lists.length; i++) {
                                result += '<li><div class="num">001号</div><div class="pic"><a href="#"><img src="upload/pic_03.jpg"></a></div><div class="name-ps clearfix"><span class="name">张玉婷</span><span class="piaoshu">票数<strong>12345</strong></span></div><div class="age-rank clearfix"><span class="age">年龄12</span><span class="rank">排名<strong>1</strong></span></div><a href="#" class="tp-btn">投TA一票</a></li>';
                            }
                            setTimeout(function() { //测试用 后端请删除timeout的函数
                                $(".tp-list-1").append(result);
                                if (!data.lists.length || data.lists.length < itemPageNum) {
                                    // 锁定
                                    me.lock();
                                    // 无数据
                                    me.noData(); 
                                }
                                me.resetload();

                            }, 2000)

                        },
                        error: function(xhr, type) {
                            console.dir('Ajax error!');
                            // 即使加载出错，也得重置
                            me.resetload();
                        }
                    });
                }
            });
            }
            

        })()
    })
    </script>
</body>

</html>